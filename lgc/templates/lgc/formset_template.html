{% load formset_tags %}
{% load crispy_forms_tags %}
{% load i18n %}

<label><b>{{ formset_title }}</b></label>
<div id="formset" data-formset-prefix="{{ formset.prefix }}">
  {{ formset.management_form }}

  <div data-formset-body>
    <!-- New forms will be inserted in here -->
    {% for form in formset %}

    {% if forloop.first %}
    <div class="form-row">
      {% for f in form.visible_fields %}
      <div class="form-group col-md-2">
	{{ f.label|capfirst }}
	{% if f.field.required %}<span class="asteriskField">*</span>{% endif %}
      </div>
      {% endfor %}
    </div>
    {% endif %}

    <div data-formset-form class="form-row">
      {% for f in form.hidden_fields %}
      {{ f }}
      {% endfor %}
      {% for f in form.visible_fields %}
      <div class="form-group col-md-2">
	{{ f }}
	{% if f.errors %}
	<span class="invalid-feedback" style="display:inline;">
	  <strong>{{ f.errors.0 }}</strong>
	</span>
	{% endif %}
      </div>
      {% endfor %}
    </div>
    {% endfor %}
  </div>

  <script type="form-template" data-formset-empty-form>
    {% escapescript %}
    <div data-formset-form class="form-row">
      {% for f in formset.empty_form.hidden_fields %}
      {{ f }}
      {% endfor %}
      {% for f in formset.empty_form.visible_fields %}
      <div class="form-group col-md-2">{{ f }}</div>
      {% endfor %}
    </div>
    {% endescapescript %}
  </script>

  <input type="button" value="{{ formset_add_text }}" data-formset-add>
